[pytest]
# 1. Rutas de búsqueda de tests:
#    Busca recursivamente archivos de prueba en TODAS las subcarpetas dentro de 'services'.
testpaths = services

# 2. Configuración estándar para descubrimiento de archivos/clases/funciones
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# 3. Solución para 'ModuleNotFoundError: No module named 'src''
#    Al añadir la carpeta 'services' al PATH, Python puede encontrar la estructura
#    interna de los módulos: services/order/src, services/user/src, etc.
#    Esta es la mejor solución estática para un monorepo simple.
python_paths = services

# 4. Opciones de línea de comandos (addopts)
addopts =
    -v
    --tb=short
    --strict-markers
    --disable-warnings
    # Cobertura: Mide toda la carpeta 'services', que contiene todos los microservicios.
    --cov=services
    --cov-report=html
    --cov-report=xml
    --cov-report=term-missing
    --cov-fail-under=70

markers =
    slow: marks tests as slow (deselect with '-m "not slow"')
    integration: marks tests as integration tests
